"0","set.seed(444)"
"0","n <- 100   # Numbers of data"
"0","q <- 2     # Number of covariables"
"0","G <- 2     # Number of groups"
"0",""
"0","X1 <- mvrnorm(n/2, mu = c(0,0), Sigma = rbind(c(0.5,0), # Group 1"
"0","                                            c(0,0.5)))"
"0","X2 <- mvrnorm(n/2, mu = c(3, 3), Sigma = rbind(c(0.5,0), # Group 2"
"0","                                            c(0,0.5)))"
"0",""
"0","S2.inv <- solve(rbind(c(0.5,0), c(0,0.5)))"
"0","w2 <- S2.inv %*% c(2,2)"
"0","w20 <- - c(2,2) %*% S2.inv %*% c(2,2)/2 - 3"
"0",""
"0","gamma <- matrix(c(0,0,0, c(w20,w2)), ncol=2)"
"0",""
"0","X_tild <- cbind(rep(1,n), rbind(X1,X2))"
"0","X_tild <- X_tild[sample(1:nrow(X_tild)),]"
"0",""
"0","# Gamma coefficients"
"0","# gamma <- matrix(c(0,0,0,-10,10,10), ncol = q)"
"0",""
"0","lin <- X_tild %*% gamma"
"0","eta <- exp(lin) / rowSums(exp(lin)) # Softmax to get proportions between 0 and 1"
"0",""
"0","# Gaussian distributions parameters"
"0","mu <- c(1, 2)"
"0","sigma <- c(1, 2)"
"0",""
"0","# Defining the group of each observations using the values of eta as proba"
"0","group <- apply(eta, 1, function(p) sample(1:G, 1, prob = p))"
"0",""
"0","# Target variable generation"
"0","y <- rnorm(n, mean = mu[group], sd = sigma[group])"
"0",""
"0","data <- data.frame(y = y, x0 = X_tild[,1], x1 = X_tild[, 2], x2 = X_tild[, 3], group = group)"
"0",""
"0","ggplot(data, aes(x = x1, y = x2, color = factor(group))) +"
"0","  geom_point() +"
"0","  labs(title = ""Simple Mixture of Expert"","
"0","       x = ""x1"","
"0","       y = ""x2"","
"0","       color = ""Group"")"
